<div class="list-container">
  @if (loading()) {
    <div class="panel" style="text-align: center">
      <p class="muted">Cargando registros...</p>
    </div>
  } @else {
    <div class="search-container" style="margin-bottom: 16px;">
      <input
        type="text"
        placeholder="Buscar pacientes..."
        [value]="searchTerm()"
        (input)="searchTerm.set($any($event.target).value)"
        style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
      />
    </div>
    @if (filteredPatients().length === 0 && patients().length > 0) {
      <div class="panel" style="text-align: center; padding: 48px">
        <div class="muted" style="font-size: 1.1rem;">No se encontraron pacientes que coincidan con la b√∫squeda</div>
      </div>
    } @else if (patients().length === 0) {
      <div class="panel" style="text-align: center; padding: 48px">
        <div class="muted" style="font-size: 1.1rem; margin-bottom: 16px">No se encontraron pacientes</div>
        <button class="btn btn-primary" (click)="onAddPatient()">Crear tu primer paciente</button>
      </div>
    } @else {
      <div class="cards">
        @for (patient of filteredPatients(); track patient.id) {
          <div class="card">
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 12px;
              "
            >
              <div>
                <div style="font-weight: 700; font-size: 1.1rem; color: #0f172a">
                  {{ patient.firstName }} {{ patient.lastName }}
                </div>
                <div class="muted" style="margin-top: 2px">{{ patient.email }}</div>
              </div>
              <div
                class="muted"
                style="
                  font-size: 0.75rem;
                  background: #f1f5f9;
                  padding: 2px 8px;
                  border-radius: 6px;
                "
              >
                ID: {{ patient.id }}
              </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 4px; margin-bottom: 16px">
              @if (patient.phone) {
                <div class="muted" style="display: flex; align-items: center; gap: 6px">
                  <app-ui-icon name="Phone" size="12"></app-ui-icon> {{ patient.phone }}
                </div>
              }
              <div class="muted" style="display: flex; align-items: center; gap: 6px">
                <app-ui-icon name="Calendar" size="12"></app-ui-icon>
                {{ patient.dateOfBirth | date: 'mediumDate' }}
              </div>
            </div>

            <div style="display: flex; gap: 8px; border-top: 1px solid #f1f5f9; padding-top: 12px">
              <button class="btn" style="flex: 1" (click)="onEditPatient(patient)">
                <app-ui-icon name="Edit" size="14" class="mr-1"></app-ui-icon> Editar
              </button>
              <button class="btn btn-danger" style="flex: 1" (click)="deletePatient(patient.id!)">
                <app-ui-icon name="Trash2" size="14" class="mr-1"></app-ui-icon> Eliminar
              </button>
            </div>
          </div>
        }
      </div>
    }
  }
</div>
